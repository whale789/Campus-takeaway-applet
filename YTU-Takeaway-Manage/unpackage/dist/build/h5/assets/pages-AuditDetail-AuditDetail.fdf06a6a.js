import{D as e,m as t,y as s,x as a,o as i,a as l,d,w as r,F as n,S as o,e as u,t as c,b as h,c as m,h as p,f as y,k as f,j as g,l as P}from"./index-745be673.js";import{_,a as A}from"./uni-popup-message.9bf2ed06.js";import{r as F}from"./uni-app.es.4a269a07.js";import{a as I}from"./uni-popup.6e285b20.js";import{_ as k}from"./_plugin-vue_export-helper.1b428a4d.js";const b=k({data:()=>({AuditListId:"",MerchantPicture:"",MerchantName:"",MerchantAddress:"",MerChantPossessor:"",PossessorPhone:"",LicensePicture:"",SanitaryPermit:"",IdentityCardZ:"",IdentityCardF:"",BusinessContent:"",ImageList:[],color:"",AuditState:"",Handlers:"",HandlersPhone:0,Feedback:"",FeedbackEmpty:!1,AuditDetailId:"",HaveProcessed:!0,NotProcessed:!1,ProcessingTime:"",ApplicationTime:""}),onLoad(s){this.AuditListId=s.AuditId,e.callFunction({name:"GetAuditByListId",data:{AuditListId:this.AuditListId}}).then((e=>{this.AuditDetailId=e.result.data[0]._id,this.MerchantPicture=e.result.data[0].MerchantPicture,this.MerchantName=e.result.data[0].MerchantName,this.MerchantAddress=e.result.data[0].MerchantAddress,this.MerChantPossessor=e.result.data[0].MerChantPossessor,this.PossessorPhone=e.result.data[0].PossessorPhone,this.LicensePicture=e.result.data[0].LicensePicture,this.SanitaryPermit=e.result.data[0].SanitaryPermit,this.IdentityCardZ=e.result.data[0].IdentityCardZ,this.IdentityCardF=e.result.data[0].IdentityCardF,this.BusinessContent=e.result.data[0].BusinessContent,this.Handlers=e.result.data[0].Handlers,this.HandlersPhone=e.result.data[0].HandlersPhone,this.AuditState=e.result.data[0].AuditState,this.Feedback=e.result.data[0].Feedback,this.ApplicationTime=e.result.data[0].ApplicationTime,this.ImageList.push(this.MerchantPicture),this.ImageList.push(this.LicensePicture),this.ImageList.push(this.SanitaryPermit),this.ImageList.push(this.IdentityCardZ),this.ImageList.push(this.IdentityCardF),"未处理"==e.result.data[0].AuditState&&(this.color="color:#1296db",this.NotProcessed=!0,this.HaveProcessed=!1),"处理中"==e.result.data[0].AuditState&&(this.color="color:#ffaa00",t().globalData.Account==this.HandlersPhone?(this.NotProcessed=!0,this.HaveProcessed=!1):(this.NotProcessed=!1,this.HaveProcessed=!0)),"已通过"==e.result.data[0].AuditState&&(this.color="color:#00aa00",this.NotProcessed=!1,this.HaveProcessed=!0,this.ProcessingTime=e.result.data[0].ProcessingTime),"已驳回"==e.result.data[0].AuditState&&(this.color="color:#ff0000",this.NotProcessed=!1,this.HaveProcessed=!0,this.ProcessingTime=e.result.data[0].ProcessingTime)}))},methods:{ImagePlus(e){s({urls:this.ImageList,current:e,indicator:"default",loop:!0})},IFFeedbackEmpty(){""==this.Feedback?this.FeedbackEmpty=!0:this.FeedbackEmpty=!1},Approved(){if(0==this.FeedbackEmpty){let s=new Date,i=s.getFullYear(),l=s.getMonth()+1,d=s.getDate();l>=1&&l<=9&&(l="0"+l),d>=0&&d<=9&&(d="0"+d);var t=i+"-"+l+"-"+d;e.callFunction({name:"UpdateAuditListState",data:{AuditListId:this.AuditListId,AuditState:"已通过",HandlersAccount:this.HandlersPhone,Handlers:this.Handlers,ProcessingTime:t,Feedback:this.Feedback}}).then((s=>{e.callFunction({name:"UpdateAuditDetailById",data:{AuditDetailId:this.AuditDetailId,AuditState:"已通过",Feedback:this.Feedback,ProcessingTime:t}}).then((t=>{let s=new Date,i=s.getFullYear(),l=s.getMonth()+1,d=s.getDate();l>=1&&l<=9&&(l="0"+l),d>=0&&d<=9&&(d="0"+d);var r=i+"-"+l+"-"+d,n=(new Date).getTime()+Math.random().toString(36).substr(2),o=new Date,u=o.getFullYear(),c=o.getMonth()+1;c=c<10?"0"+c:c;var h=o.getDate(),m=u+c+(h=h<10?"0"+h:h)+o.getHours()+o.getMinutes()+o.getSeconds()+Math.random().toString(36).substr(2);e.callFunction({name:"AddNewMerchantToRestaurant",data:{StoreName:this.MerchantName,StorePicture:this.MerchantPicture,MonthOrders:0,ComplainNumber:0,OverallRate:0,SettledDate:r,Possessor:this.MerChantPossessor,PossessorPhone:this.PossessorPhone,GoodsClass:[{ClassID:m,ClassName:"默认",GoodsDetail:[{GoodsId:n,GoodsName:"默认",GoodsPrice:0,GoodsPicture:"../../static/images/DefaultFile.png",GoodsSoldNumber:0}]}],MonthMoney:0,Address:this.MerchantAddress,BusinessStatus:1,OnboardingStatus:1,AllMoney:0,AllOrders:0,IdentityCardF:this.IdentityCardF,IdentityCardZ:this.IdentityCardZ,LicensePicture:this.LicensePicture,SanitaryPermit:this.SanitaryPermit,BusinessContent:this.BusinessContent}}).then((e=>{a({url:"/pages/Audit/Audit"})}))}))}))}else this.$refs.message.open("center")},Overrule(){if(0==this.FeedbackEmpty){let s=new Date,i=s.getFullYear(),l=s.getMonth()+1,d=s.getDate();l>=1&&l<=9&&(l="0"+l),d>=0&&d<=9&&(d="0"+d);var t=i+"-"+l+"-"+d;e.callFunction({name:"UpdateAuditListState",data:{AuditListId:this.AuditListId,AuditState:"已驳回",HandlersAccount:this.HandlersPhone,Handlers:this.Handlers,ProcessingTime:t,Feedback:this.Feedback}}).then((s=>{e.callFunction({name:"UpdateAuditDetailById",data:{AuditDetailId:this.AuditDetailId,AuditState:"已驳回",Feedback:this.Feedback,ProcessingTime:t}}).then((e=>{a({url:"/pages/Audit/Audit"})}))}))}else this.$refs.message.open("center")}}},[["render",function(e,t,s,a,k,b){const C=y,x=f,w=F(g("uni-easyinput"),_),M=P,S=o,H=F(g("uni-popup-message"),A),L=F(g("uni-popup"),I);return i(),l(n,null,[d(S,{style:{"background-color":"white"},"scroll-y":"true","enable-back-to-top":"true"},{default:r((()=>[d(C,{style:{display:"flex","margin-left":"19%"}},{default:r((()=>[d(C,{style:{"margin-top":"2%"}},{default:r((()=>[u("店铺照片：")])),_:1}),d(x,{onClick:t[0]||(t[0]=e=>b.ImagePlus(0)),src:k.MerchantPicture,style:{"background-color":"white",width:"120rpx",height:"120rpx"},mode:"aspectFit"},null,8,["src"])])),_:1}),d(C,{style:{display:"flex","margin-left":"19%","margin-top":"5%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("店铺名称：")])),_:1}),d(C,{style:{width:"60%"}},{default:r((()=>[u(c(k.MerchantName),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"19%","margin-top":"5%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("店铺地址：")])),_:1}),d(C,{style:{width:"60%"}},{default:r((()=>[u(c(k.MerchantAddress),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"15.5%","margin-top":"5%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("店铺持有人：")])),_:1}),d(C,{style:{width:"57%"}},{default:r((()=>[u(c(k.MerChantPossessor),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"15.5%","margin-top":"5%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("持有人手机：")])),_:1}),d(C,null,{default:r((()=>[u(c(k.PossessorPhone),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"19%","margin-top":"5%"}},{default:r((()=>[d(C,{style:{"margin-top":"10%"}},{default:r((()=>[u("营业执照：")])),_:1}),d(x,{onClick:t[1]||(t[1]=e=>b.ImagePlus(1)),src:k.LicensePicture,style:{"background-color":"white",width:"120rpx",height:"120rpx"},mode:"aspectFit"},null,8,["src"])])),_:1}),d(C,{style:{display:"flex","margin-left":"15.5%","margin-top":"5%"}},{default:r((()=>[d(C,{style:{"margin-top":"9%"}},{default:r((()=>[u("卫生许可证：")])),_:1}),d(x,{onClick:t[2]||(t[2]=e=>b.ImagePlus(2)),src:k.SanitaryPermit,style:{"background-color":"white",width:"120rpx",height:"120rpx"},mode:"aspectFit"},null,8,["src"])])),_:1}),d(C,{style:{display:"flex","margin-left":"6%","margin-top":"5%"}},{default:r((()=>[d(C,{style:{"margin-top":"8%"}},{default:r((()=>[u("持有人身份证(正)：")])),_:1}),d(x,{onClick:t[3]||(t[3]=e=>b.ImagePlus(3)),src:k.IdentityCardZ,style:{"background-color":"white",width:"120rpx",height:"120rpx"},mode:"aspectFit"},null,8,["src"])])),_:1}),d(C,{style:{display:"flex","margin-left":"6%","margin-top":"5%"}},{default:r((()=>[d(C,{style:{"margin-top":"8%"}},{default:r((()=>[u("持有人身份证(反)：")])),_:1}),d(x,{onClick:t[4]||(t[4]=e=>b.ImagePlus(4)),src:k.IdentityCardF,style:{"background-color":"white",width:"120rpx",height:"120rpx"},mode:"aspectFit"},null,8,["src"])])),_:1}),d(C,{style:{display:"flex","margin-left":"20.5%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("经营内容：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[u(c(k.BusinessContent),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"24.5%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("处理人：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[u(c(k.Handlers),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"17%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("处理人账号：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[u(c(k.HandlersPhone),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"20.5%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("处理时间：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[u(c(k.ApplicationTime),1)])),_:1})])),_:1}),d(C,{style:{display:"flex","margin-left":"20.5%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("处理状态：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[d(C,{style:h(k.color)},{default:r((()=>[u(c(k.AuditState),1)])),_:1},8,["style"])])),_:1})])),_:1}),k.NotProcessed?(i(),m(C,{key:0,style:{display:"flex","margin-left":"6%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("处理结果：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[d(w,{type:"textarea",modelValue:k.Feedback,"onUpdate:modelValue":t[5]||(t[5]=e=>k.Feedback=e),placeholder:"请输入处理结果",onBlur:b.IFFeedbackEmpty},null,8,["modelValue","onBlur"])])),_:1})])),_:1})):p("",!0),k.FeedbackEmpty?(i(),m(C,{key:1,style:{color:"red","font-size":"20rpx","margin-left":"27%"}},{default:r((()=>[u("处理结果不能为空")])),_:1})):p("",!0),k.HaveProcessed?(i(),m(C,{key:2,style:{display:"flex","margin-left":"6%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("处理结果：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[u(c(k.Feedback),1)])),_:1})])),_:1})):p("",!0),k.HaveProcessed?(i(),m(C,{key:3,style:{display:"flex","margin-left":"20.5%","margin-top":"8%"}},{default:r((()=>[d(C,null,{default:r((()=>[u("处理时间：")])),_:1}),d(C,{style:{width:"70%"}},{default:r((()=>[u(c(k.ProcessingTime),1)])),_:1})])),_:1})):p("",!0),d(C,{style:{height:"150rpx"}}),k.NotProcessed?(i(),m(C,{key:4,style:{display:"flex","flex-direction":"row","justify-content":"center"}},{default:r((()=>[d(M,{type:"primary",style:{width:"33%"},size:"mini",onClick:b.Approved},{default:r((()=>[u("通过")])),_:1},8,["onClick"]),d(M,{type:"warn",style:{width:"33%"},size:"mini",onClick:b.Overrule},{default:r((()=>[u("驳回")])),_:1},8,["onClick"])])),_:1})):p("",!0),d(C,{style:{height:"200rpx"}})])),_:1}),d(L,{ref:"message",type:"message"},{default:r((()=>[d(H,{type:"error",message:"请先按要求填写内容",duration:2e3})])),_:1},512)],64)}]]);export{b as default};
